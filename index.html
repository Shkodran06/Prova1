<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Arbeits Planner</title>
<style>
body { font-family: Arial; margin: 20px; }
.hidden { display: none; }
button { margin-left: 5px; }
input { margin: 3px; }
pre { background: #f4f4f4; padding: 10px; white-space: pre-wrap; }
.section { border: 1px solid #ccc; padding: 10px; margin-bottom: 15px; }
</style>
</head>
<body>

<h1>Arbeits Planner</h1>

<!-- LOGIN -->
<div class="section">
  <h3>Login Admin (opzionale)</h3>
  <input id="user" placeholder="Username">
  <input id="pass" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <span id="loginStatus"></span>
</div>

<!-- ADMIN -->
<div class="section hidden" id="admin">
  <h3>Gestione Arbeiter</h3>

  <input id="newName" placeholder="Nome e Cognome">
  <button onclick="addWorker()">+</button>

  <ul id="workerList"></ul>
</div>

<!-- PROGRAMMAZIONE -->
<div class="section">
  <h3>Programmazione – Seleziona presenti</h3>
  <div id="presentList"></div>
  <button onclick="generate()">Genera programma</button>
</div>

<!-- OUTPUT -->
<div class="section">
  <h3>Output</h3>
  <pre id="output"></pre>
</div>

<script>
/* ===== CONFIG ===== */
const ADMIN_USER = "Shkodran";
const ADMIN_PASS = "Shkodran2006@";

/* ===== STATE ===== */
let isAdmin = false;
let workers = JSON.parse(localStorage.getItem("workers")) || [];

/* ===== UTILS ===== */
function save() {
  localStorage.setItem("workers", JSON.stringify(workers));
}

/* ===== LOGIN ===== */
function login() {
  if (user.value === ADMIN_USER && pass.value === ADMIN_PASS) {
    isAdmin = true;
    document.getElementById("admin").classList.remove("hidden");
    loginStatus.textContent = "✔ Login effettuato";
    renderWorkers();
  } else {
    alert("Credenziali errate");
  }
}

/* ===== ADMIN ===== */
function addWorker() {
  if (!newName.value.trim()) return;
  workers.push({ id: Date.now(), name: newName.value.trim() });
  newName.value = "";
  save();
  renderWorkers();
  renderPresent();
}

function removeWorker(id) {
  workers = workers.filter(w => w.id !== id);
  save();
  renderWorkers();
  renderPresent();
}

function editWorker(id) {
  const w = workers.find(x => x.id === id);
  const nuovo = prompt("Modifica nome:", w.name);
  if (nuovo) {
    w.name = nuovo.trim();
    save();
    renderWorkers();
    renderPresent();
  }
}

function renderWorkers() {
  if (!isAdmin) return;
  workerList.innerHTML = "";
  workers.forEach(w => {
    workerList.innerHTML += `
      <li>${w.name}
        <button onclick="editWorker(${w.id})">✏️</button>
        <button onclick="removeWorker(${w.id})">−</button>
      </li>`;
  });
}

/* ===== PROGRAMMAZIONE ===== */
function renderPresent() {
  presentList.innerHTML = "";
  workers.forEach(w => {
    presentList.innerHTML += `
      <label>
        <input type="checkbox" value="${w.name}">
        ${w.name}
      </label><br>`;
  });
}

/* ===== GENERAZIONE OUTPUT ===== */
function generate() {
  const selected = [...document.querySelectorAll("#presentList input:checked")]
    .map(c => c.value);

  let out = "";

  for (let i = 1; i <= 10; i++) {
    out += `Midi ${i}\t${selected[i-1] || ""}\n`;
  }

  out += `\nStammdaten 1\t${selected[10] || ""}\n`;
  out += `Stammdaten 2\t${selected[11] || ""}\n\n`;

  out += `SSCC Druck\n\t${selected[12] || ""}\n\n`;

  out += `Separation 1\n\t${selected[13] || ""}\n`;
  out += `Separation 2\n\t${selected[14] || ""}\n`;
  out += `Separation 3\n\t${selected[15] || ""}\n\n`;

  out += `Band aufgeben\n\t${selected[16] || ""}\n`;
  out += `Band aufgeben\n\t${selected[17] || ""}\n`;

  output.textContent = out;
}

/* INIT */
renderPresent();
</script>

</body>
</html>
