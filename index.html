<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Arbeits Planner</title>
<style>
body { font-family: Arial; margin: 20px; }
.hidden { display: none; }
button { margin: 5px; }
pre { background: #f4f4f4; padding: 10px; }
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login">
  <h2>Login Admin</h2>
  <input id="user" placeholder="Username"><br>
  <input id="pass" type="password" placeholder="Password"><br>
  <button onclick="login()">Accedi</button>
</div>

<!-- ADMIN -->
<div id="admin" class="hidden">
  <h2>Gestione Arbeiter</h2>
  <input id="name" placeholder="Nome e Cognome">
  <button onclick="addWorker()">+</button>

  <ul id="workerList"></ul>

  <button onclick="goPlanner()">Vai alla programmazione</button>
</div>

<!-- PLANNER -->
<div id="planner" class="hidden">
  <h2>Seleziona presenti</h2>
  <div id="presentList"></div>

  <button onclick="generate()">Genera programma</button>
  <pre id="output"></pre>
</div>

<script>
const ADMIN_USER = "admin";
const ADMIN_PASS = "1234";

let workers = JSON.parse(localStorage.getItem("workers")) || [];

function save() {
  localStorage.setItem("workers", JSON.stringify(workers));
}

function login() {
  if (user.value === ADMIN_USER && pass.value === ADMIN_PASS) {
    loginDiv(false);
    adminDiv(true);
    renderWorkers();
  } else alert("Login errato");
}

function loginDiv(show) { document.getElementById("login").classList.toggle("hidden", !show); }
function adminDiv(show) { document.getElementById("admin").classList.toggle("hidden", !show); }
function plannerDiv(show) { document.getElementById("planner").classList.toggle("hidden", !show); }

function addWorker() {
  if (!name.value) return;
  workers.push({ id: Date.now(), name: name.value });
  name.value = "";
  save();
  renderWorkers();
}

function removeWorker(id) {
  workers = workers.filter(w => w.id !== id);
  save();
  renderWorkers();
}

function renderWorkers() {
  workerList.innerHTML = "";
  workers.forEach(w => {
    workerList.innerHTML += `
      <li>${w.name}
      <button onclick="removeWorker(${w.id})">-</button>
      </li>`;
  });
}

function goPlanner() {
  adminDiv(false);
  plannerDiv(true);
  renderPresent();
}

function renderPresent() {
  presentList.innerHTML = "";
  workers.forEach(w => {
    presentList.innerHTML += `
      <label>
        <input type="checkbox" value="${w.name}">
        ${w.name}
      </label><br>`;
  });
}

function generate() {
  const selected = [...document.querySelectorAll("input[type=checkbox]:checked")]
    .map(c => c.value);

  let out = "";

  // MIDI
  for (let i = 1; i <= 10; i++) {
    out += `Midi ${i}\t${selected[i-1] || ""}\n`;
  }

  out += `\nStammdaten 1\t${selected[10] || ""}\n`;
  out += `Stammdaten 2\t${selected[11] || ""}\n\n`;

  out += `SSCC Druck\n\t${selected[12] || ""}\n\n`;

  out += `Separation 1\n\t${selected[13] || ""}\n`;
  out += `Separation 2\n\t${selected[14] || ""}\n`;
  out += `Separation 3\n\t${selected[15] || ""}\n\n`;

  out += `Band aufgeben\n\t${selected[16] || ""}\n`;
  out += `Band aufgeben\n\t${selected[17] || ""}\n`;

  output.textContent = out;
}
</script>

</body>
</html>

